#!/bin/bash
# Transcription using Groq Whisper API (fast & cheap)
# Setup: Replace YOUR_API_KEY_HERE with your Groq API key
# Usage: transcribe-groq /path/to/audio.ogg

set -e

#=== CONFIGURATION ===
GROQ_API_KEY="YOUR_API_KEY_HERE"  # Get from: https://console.groq.com/keys
MODEL="whisper-large-v3-turbo"    # Options: whisper-large-v3, whisper-large-v3-turbo, distil-whisper-large-v3-en
#=====================

if [ "$GROQ_API_KEY" = "YOUR_API_KEY_HERE" ]; then
    echo "Error: Edit this script and set your GROQ_API_KEY" >&2
    exit 1
fi

AUDIO_FILE="$1"
if [ -z "$AUDIO_FILE" ]; then
    echo "Usage: $0 <audio_file>" >&2
    exit 1
fi

# Call Groq Whisper API (OpenAI-compatible endpoint)
RESPONSE=$(curl -s "https://api.groq.com/openai/v1/audio/transcriptions" \
    -H "Authorization: Bearer $GROQ_API_KEY" \
    -F "file=@$AUDIO_FILE" \
    -F "model=$MODEL" \
    -F "response_format=text")

# Check for errors
if echo "$RESPONSE" | grep -q '"error"'; then
    echo "Error: $RESPONSE" >&2
    exit 1
fi

echo "$RESPONSE"
