#!/bin/bash
# Transcription using OpenAI Whisper API
# Setup: Replace YOUR_API_KEY_HERE with your OpenAI API key
# Usage: transcribe-openai /path/to/audio.ogg

set -e

#=== CONFIGURATION ===
OPENAI_API_KEY="YOUR_API_KEY_HERE"  # Get from: https://platform.openai.com/api-keys
#=====================

if [ "$OPENAI_API_KEY" = "YOUR_API_KEY_HERE" ]; then
    echo "Error: Edit this script and set your OPENAI_API_KEY" >&2
    exit 1
fi

AUDIO_FILE="$1"
if [ -z "$AUDIO_FILE" ]; then
    echo "Usage: $0 <audio_file>" >&2
    exit 1
fi

# Call OpenAI Whisper API
RESPONSE=$(curl -s "https://api.openai.com/v1/audio/transcriptions" \
    -H "Authorization: Bearer $OPENAI_API_KEY" \
    -F "file=@$AUDIO_FILE" \
    -F "model=whisper-1" \
    -F "response_format=text")

# Check for errors
if echo "$RESPONSE" | grep -q '"error"'; then
    echo "Error: $RESPONSE" >&2
    exit 1
fi

echo "$RESPONSE"
